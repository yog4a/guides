# =====================================================================
# UFW Rules for NATS JetStream Cluster (RESTRICTED ACCESS)
# Allow NATS access only from specific trusted IP addresses
# Recommended for production environments
# =====================================================================

# Replace YOUR_APP_SERVER_IP with actual IP addresses of your application servers

# Allow NATS client port from specific IPs only
sudo ufw allow from YOUR_APP_SERVER_IP to any port 4222 proto tcp comment 'NATS Client (App Server 1)'
# sudo ufw allow from ANOTHER_APP_IP to any port 4222 proto tcp comment 'NATS Client (App Server 2)'

# Allow NATS monitoring from your admin IP only (optional)
sudo ufw allow from YOUR_ADMIN_IP to any port 8222 proto tcp comment 'NATS Monitoring (Admin)'

# Example with actual IPs:
# sudo ufw allow from 10.0.0.5 to any port 4222 proto tcp comment 'NATS Client (Backend)'
# sudo ufw allow from 10.0.0.6 to any port 4222 proto tcp comment 'NATS Client (Worker)'
# sudo ufw allow from 192.168.1.100 to any port 8222 proto tcp comment 'NATS Monitoring (Admin)'

# Reload UFW to apply changes
sudo ufw reload

# Verify rules
sudo ufw status numbered

# Note: This is the most secure configuration for production
# Only explicitly whitelisted IPs can access NATS

