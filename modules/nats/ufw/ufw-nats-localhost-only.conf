# =====================================================================
# UFW Rules for NATS JetStream Cluster (LOCALHOST ONLY)
# This configuration keeps NATS accessible only from the same server
# Applications must run on the same server to connect to NATS
# =====================================================================

# DO NOT add these rules if you want localhost-only access:
# sudo ufw allow 4222/tcp comment 'NATS Client Port'
# sudo ufw allow 8222/tcp comment 'NATS HTTP Monitoring'

# NATS will automatically listen on 0.0.0.0:4222 (as configured in nats-server.conf)
# but UFW will block external access, allowing only localhost connections

# To verify NATS is listening but not accessible externally:
# From the server:
#   nats pub test.subject "hello" --server=localhost:4222  # ✅ Works
# 
# From another machine:
#   nats pub test.subject "hello" --server=YOUR_SERVER_IP:4222  # ❌ Blocked by UFW

# Optional: If you need HTTP monitoring accessible from specific IP only:
# sudo ufw allow from YOUR_TRUSTED_IP to any port 8222 proto tcp comment 'NATS Monitoring (restricted)'

# Note: Docker containers on the same server can still access NATS via:
# - Host network mode: localhost:4222
# - Bridge network: host.docker.internal:4222 (Linux) or gateway IP

